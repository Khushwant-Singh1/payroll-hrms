generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Employee {
  id                       String         @id @default(cuid())
  employeeId               String         @unique
  name                     String
  email                    String         @unique
  phone                    String
  department               String
  designation              String
  company                  String
  location                 String?
  grade                    String?
  status                   EmployeeStatus @default(active)
  joiningDate              DateTime
  dateOfBirth              DateTime?
  basicSalary              Decimal        @db.Decimal(12, 2)
  hra                      Decimal        @db.Decimal(12, 2)
  pan                      String?
  aadhaar                  String?
  uan                      String?
  esicNumber               String?
  pfOptIn                  Boolean        @default(true)
  esiApplicable            Boolean        @default(true)
  lwfState                 String?
  bankAccount              String?
  ifsc                     String?
  branch                   String?
  profilePic               String?
  createdAt                DateTime       @default(now())
  updatedAt                DateTime       @updatedAt
  bonus                    Decimal        @db.Decimal(12, 2)
  conveyanceAllowance      Decimal        @db.Decimal(12, 2)
  dearnessAllowance        Decimal        @db.Decimal(12, 2)
  employerEsicContribution Decimal        @db.Decimal(12, 2)
  employerPfContribution   Decimal        @db.Decimal(12, 2)
  esicDeduction            Decimal        @db.Decimal(12, 2)
  foodAllowance            Decimal        @db.Decimal(12, 2)
  incomeTaxDeduction       Decimal        @db.Decimal(12, 2)
  insuranceDeduction       Decimal        @db.Decimal(12, 2)
  lastPaymentDate          DateTime?
  lastTransactionId        String?
  leaveWithWages           Decimal        @db.Decimal(12, 2)
  officeWearAllowance      Decimal        @db.Decimal(12, 2)
  otherAllowances          Decimal        @db.Decimal(12, 2)
  otherRecoveries          Decimal        @db.Decimal(12, 2)
  overtimeRate             Decimal        @db.Decimal(8, 2)
  pfDeduction              Decimal        @db.Decimal(12, 2)
  rateOfWages              Decimal        @db.Decimal(12, 2)
  societyDeduction         Decimal        @db.Decimal(12, 2)
  specialBasic             Decimal        @db.Decimal(12, 2)
  attendance               Attendance[]
}

model EmployeeDraft {
  id                       String         @id @default(cuid())
  employeeId               String?
  name                     String?
  email                    String?
  phone                    String?
  department               String?
  designation              String?
  company                  String?
  location                 String?
  grade                    String?
  status                   EmployeeStatus @default(active)
  joiningDate              String?
  dateOfBirth              String?
  basicSalary              Decimal?       @db.Decimal(12, 2)
  hra                      Decimal?       @db.Decimal(12, 2)
  pan                      String?
  aadhaar                  String?
  uan                      String?
  esicNumber               String?
  pfOptIn                  Boolean        @default(true)
  esiApplicable            Boolean        @default(true)
  lwfState                 String?
  bankAccount              String?
  ifsc                     String?
  branch                   String?
  profilePic               String?
  createdBy                String?
  lastModified             DateTime       @default(now()) @updatedAt
  createdAt                DateTime       @default(now())
  bonus                    Decimal?       @db.Decimal(12, 2)
  conveyanceAllowance      Decimal?       @db.Decimal(12, 2)
  dearnessAllowance        Decimal?       @db.Decimal(12, 2)
  employerEsicContribution Decimal?       @db.Decimal(12, 2)
  employerPfContribution   Decimal?       @db.Decimal(12, 2)
  esicDeduction            Decimal?       @db.Decimal(12, 2)
  foodAllowance            Decimal?       @db.Decimal(12, 2)
  incomeTaxDeduction       Decimal?       @db.Decimal(12, 2)
  insuranceDeduction       Decimal?       @db.Decimal(12, 2)
  lastPaymentDate          DateTime?
  lastTransactionId        String?
  leaveWithWages           Decimal?       @db.Decimal(12, 2)
  officeWearAllowance      Decimal?       @db.Decimal(12, 2)
  otherAllowances          Decimal?       @db.Decimal(12, 2)
  otherRecoveries          Decimal?       @db.Decimal(12, 2)
  overtimeRate             Decimal?       @db.Decimal(8, 2)
  pfDeduction              Decimal?       @db.Decimal(12, 2)
  rateOfWages              Decimal?       @db.Decimal(12, 2)
  societyDeduction         Decimal?       @db.Decimal(12, 2)
  specialBasic             Decimal?       @db.Decimal(12, 2)

  @@map("employee_drafts")
}

model StatutoryReturn {
  id          String   @id @default(cuid())
  title       String
  generatedAt DateTime @default(now())
  data        Json?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Attendance {
  id             String   @id @default(cuid())
  employeeId     String
  month          String
  year           Int
  presentDays    Int
  totalDays      Int
  overtimeHours  Decimal  @db.Decimal(5, 2)
  leavesTaken    Int
  shiftAllowance Decimal  @db.Decimal(12, 2)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  employee       Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)
}

enum EmployeeStatus {
  active
  inactive
}
